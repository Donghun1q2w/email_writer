# Outlook VBA 매크로 설치 가이드

EmailWriter VBA 매크로를 Outlook에 설치하는 단계별 가이드입니다. 이 가이드는 Windows 10의 Outlook 2013-2016을 대상으로 합니다.

## 사전 요구사항

설치를 진행하기 전에 다음 사항을 확인하세요.

- **운영체제**: Windows 10
- **Outlook**: Microsoft Outlook 2013, 2016
- **Python 서버**: `scripts/start_server.py`가 실행 중이어야 함

## 설치 순서

### 1단계: 매크로 보안 설정

VBA 매크로를 실행하려면 먼저 Outlook의 매크로 보안 설정을 조정해야 합니다.

1. Outlook을 열고 **파일** 메뉴를 클릭합니다.
2. **옵션**을 선택합니다.
3. 왼쪽 패널에서 **보안 센터**를 클릭합니다.
4. **보안 센터 설정** 버튼을 클릭합니다.
5. **매크로 설정**을 선택합니다.
6. 다음 중 하나를 선택합니다:
   - **모든 매크로에 대해 알림**: 매크로 실행 시 확인 대화 표시 (권장)
   - **모든 매크로 포함**: 확인 없이 모든 매크로 실행
7. **확인**을 클릭합니다.

### 2단계: VBA 편집기 열기

VBA 편집기에서 매크로를 가져와야 합니다.

1. **Alt + F11** 키를 동시에 눌러 VBA 편집기를 열거나,
2. 또는 **개발 도구** 탭에서 **Visual Basic** 버튼을 클릭합니다.

> 개발 도구 탭이 보이지 않으면, 파일 > 옵션 > 리본 사용자 지정에서 "개발 도구" 체크박스를 활성화하세요.

### 3단계: VBA 모듈 가져오기

EmailWriter.bas 파일을 VBA 편집기로 가져옵니다.

1. VBA 편집기 메뉴에서 **파일**을 클릭합니다.
2. **파일 가져오기** (또는 **Import File**)를 선택합니다. (단축키: **Ctrl + M**)
3. **EmailWriter.bas** 파일을 찾아 선택합니다.
4. **열기** 버튼을 클릭합니다.
5. VBA 편집기의 왼쪽 프로젝트 탐색기에 `EmailWriter` 모듈이 추가되었는지 확인합니다.

### 4단계: 단축키 설정 (선택사항)

매크로 실행 속도를 높이기 위해 단축키를 설정할 수 있습니다.

#### 방법 1: Quick Access Toolbar에 추가

1. Outlook에서 **Alt + F8**을 눌러 매크로 목록을 엽니다.
2. **EmailWriter.GenerateEmail** (또는 유사한 이름)을 선택합니다.
3. 원하는 방법으로 추가합니다:
   - Quick Access Toolbar에 추가하여 한 번의 클릭으로 실행 가능

#### 방법 2: 커스텀 리본 버튼 추가

1. Outlook에서 **파일 > 옵션 > 리본 사용자 지정**으로 이동합니다.
2. 새 그룹을 만들거나 기존 그룹을 선택합니다.
3. **새 매크로 제어 추가** 버튼으로 `EmailWriter.GenerateEmail` 매크로를 추가합니다.

## 사용 방법

### 메일 작성 전 준비

1. **Python 서버 실행**: 명령 프롬프트 또는 PowerShell을 열고 다음 명령어를 실행합니다:
   ```
   python scripts/start_server.py
   ```
   서버가 성공적으로 시작되면 다음과 같은 메시지가 표시됩니다:
   ```
   Server running on http://localhost:8599
   ```

### 메일 생성 단계

1. Outlook에서 **새 메일** 또는 **회신** 메일 작성 창을 엽니다.
2. 본문에 생성하려는 이메일의 요지나 주요 키워드를 입력합니다.
   - 예: "고객에게 프로젝트 진행 상황 알리기"
   - 또는: "회의 일정 변경 안내"
3. 입력한 텍스트를 마우스로 드래그하여 **선택(블록)**합니다.
4. **Alt + F8**을 눌러 매크로 목록을 엽니다.
5. **EmailWriter.GenerateEmail**을 선택하고 **실행**을 클릭합니다.
   - 또는 설정한 단축키를 눌러 직접 실행합니다.
6. 다이얼로그 창이 나타납니다:
   - **추가 지시사항** 입력란에 필요한 특수 요청사항이 있으면 입력합니다.
   - 예: "회사 공식 용어 사용", "친근한 톤으로"
   - 특별한 요청이 없으면 입력란을 비우고 확인합니다.
7. 잠시 후 생성된 이메일 본문이 선택된 영역을 대체합니다.
8. 필요에 따라 생성된 내용을 검토하고 수정한 후 발송합니다.

## 문제 해결

### 매크로 실행 관련 오류

| 오류 메시지 | 원인 | 해결 방법 |
|-----------|------|---------|
| "열려있는 메일 편집기가 없습니다" | 메일 작성 창이 활성화되지 않은 상태 | 메일 작성 창을 먼저 열고 그 위에서 매크로를 실행하세요 |
| "서버 응답을 파싱할 수 없습니다" | Python 서버가 실행 중이 아님 | `python scripts/start_server.py` 명령어로 서버를 시작하세요 |
| "서버에 연결할 수 없습니다" | 서버 주소 또는 포트 오류 | 아래의 "서버 설정" 섹션을 참조하여 설정을 확인하세요 |
| 매크로가 실행되지 않음 | Outlook 보안 설정이 너무 제한적 | "1단계: 매크로 보안 설정"을 다시 확인하세요 |
| VBA 편집기에 모듈이 보이지 않음 | 파일 가져오기 실패 | "3단계: VBA 모듈 가져오기"를 다시 진행하세요 |

### 성능 관련

- **매크로 반응이 느림**: Python 서버의 응답 시간을 확인하세요. 서버 설정의 `REQUEST_TIMEOUT` 값을 조정할 수 있습니다.
- **반복적인 오류**: Outlook을 재시작하고 VBA 프로젝트를 다시 로드해보세요.

## 서버 설정

### 기본 설정

EmailWriter VBA 모듈은 기본적으로 다음 서버 주소로 연결됩니다:

```
http://localhost:8599
```

### 커스텀 서버 주소 설정

만약 다른 서버 주소나 포트를 사용해야 한다면, VBA 편집기에서 모듈을 수정하세요.

1. VBA 편집기에서 **EmailWriter** 모듈을 열거나 더블클릭합니다.
2. 파일 맨 위의 상수 선언 섹션을 찾습니다:
   ```vba
   Const SERVER_URL = "http://localhost:8599"
   Const REQUEST_TIMEOUT = 30000
   ```
3. 필요에 따라 다음을 수정합니다:
   - **SERVER_URL**: 서버의 실제 주소와 포트로 변경
     - 예: `"http://192.168.1.100:8599"`
     - 또는: `"http://example.com:8599"`
   - **REQUEST_TIMEOUT**: 응답 대기 시간을 밀리초 단위로 설정 (기본값: 30,000ms = 30초)
     - 느린 네트워크: 60000 (60초)로 증가
     - 빠른 네트워크: 10000 (10초)로 감소
4. **Ctrl + S**로 변경 사항을 저장합니다.
5. Outlook을 재시작합니다.

## 보안 주의사항

- **신뢰할 수 없는 VBA 코드를 실행하지 마세요**: 이 문서의 단계를 따라 공식 소스에서만 모듈을 가져오세요.
- **Python 서버 보안**: 로컬 네트워크에서만 서버를 실행하는 것이 좋습니다. 외부 네트워크에 노출하지 않도록 주의하세요.
- **매크로 자동 실행**: 신뢰하는 발신자의 메일만 처리하도록 주의하세요.

## 추가 정보

- **지원 버전**: Outlook 2013, 2016 (Windows 10)
- **Python 요구사항**: Python 3.6 이상
- **VBA 버전**: Office VBA 모듈이 포함된 모든 버전

문제가 발생하거나 추가 지원이 필요하면 프로젝트 저장소의 이슈 트래커를 참조하세요.
